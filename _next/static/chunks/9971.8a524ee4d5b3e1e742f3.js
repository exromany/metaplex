(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9971],{45963:function(e,n,i){"use strict";i.d(n,{P:function(){return h}});var t=i(92847),r=i.n(t),a=i(76588),s=i(69819),o=i(71800),c=i(83871),l=i(35551),u=i(48834).Buffer;function d(e,n,i,t){return p.apply(this,arguments)}function p(){return(p=(0,a.Z)(r().mark((function e(n,i,t,a){var d,p,f,m,b;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=(0,s.programIds)(),p=d.store){e.next=4;break}throw new Error("Store not initialized");case 4:f=new l.kv({public:n}),m=u.from((0,c.serialize)(l.Yi,f)),b=[{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:d.token,isSigner:!1,isWritable:!1},{pubkey:d.vault,isSigner:!1,isWritable:!1},{pubkey:d.metadata,isSigner:!1,isWritable:!1},{pubkey:d.auction,isSigner:!1,isWritable:!1},{pubkey:d.system,isSigner:!1,isWritable:!1},{pubkey:o.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],a.push(new o.TransactionInstruction({keys:b,programId:d.metaplex,data:m}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f=i(48834).Buffer;function m(e,n,i,t,r){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)(r().mark((function e(n,i,t,a,u){var d,p,m,b,h,y;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=(0,s.programIds)(),p=d.store){e.next=4;break}throw new Error("Store not initialized");case 4:return e.next=6,(0,l.nO)(n);case 6:m=e.sent,b=new l.Vz({activated:i}),h=f.from((0,c.serialize)(l.Yi,b)),y=[{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:d.system,isSigner:!1,isWritable:!1},{pubkey:o.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],u.push(new o.TransactionInstruction({keys:y,programId:d.metaplex,data:h}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,n,i,t){return y.apply(this,arguments)}function y(){return(y=(0,a.Z)(r().mark((function e(n,i,t,a){var o,c,l,u,p,f,b,h;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],c=[],l=[],u=[],e.next=6,d(t,i.publicKey,i.publicKey,u);case 6:o.push(l),c.push(u),p=0;case 9:if(!(p<a.length)){e.next=20;break}return f=a[p],b=[],h=[],e.next=15,m(f.address,f.activated,i.publicKey,i.publicKey,h);case 15:o.push(b),c.push(h);case 17:p++,e.next=9;break;case 20:if(1!==c.length){e.next=25;break}return e.next=23,(0,s.sendTransactionWithRetry)(n,i,c[0],o[0],"single");case 23:e.next=27;break;case 25:return e.next=27,(0,s.sendTransactions)(n,i,c,o,s.SequenceType.StopOnFailure,"single");case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9971:function(e,n,i){"use strict";i.r(n),i.d(n,{HomeView:function(){return M},LiveAuctionViewState:function(){return t},default:function(){return I}});var t,r=i(52322),a=i(92847),s=i.n(a),o=i(76588),c=i(32113),l=i(2784),u=i(73884),d=i(37488),p=i(24832),f=i(3086),m=i(3306),b=i(97e3),h=i(80318),y=i(57836),x=i(35590),v=i(93977),g=i(45719),k=i(39097),j=function(e){var n=e.auction,i=(0,g.jq)().isLoading,t=null===n||void 0===n?void 0:n.thumbnail.metadata.pubkey,a=(0,y.fV)();return i?(0,r.jsx)(h.Z,{}):(0,r.jsxs)(m.Z,{className:"presale",children:[(0,r.jsx)(f.Z,{md:12,className:"explore",children:(0,r.jsx)(x.$,{pubkey:t,className:"artwork-image",allowMeshRender:!0})}),(0,r.jsxs)(f.Z,{md:12,className:"presale-info",children:[(0,r.jsx)("h2",{className:"art-title",children:a.title}),n&&(0,r.jsx)(v.W,{auctionView:n,style:{background:"transparent",width:"100%",padding:0,margin:0},hideDefaultAction:!0,action:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(k.default,{href:"/auction/".concat(n.auction.pubkey.toBase58()),children:(0,r.jsx)(p.Z,{type:"primary",size:"large",className:"action-btn",style:{maxWidth:290},children:"Go to auction"})})})})]})]})},w=i(24419),S=i(69819),N=i(88614),E=w.Z.Meta,Z=function(e){var n,i,t,a=e.auctionView,s=a.thumbnail.metadata.pubkey,o=(0,y.fV)(s),c=(null===o||void 0===o?void 0:o.title)||" ",u=(0,l.useState)(),d=u[0],p=u[1],f=(0,y.hc)(a.auction.pubkey),m=(0,S.useMint)(a.auction.info.tokenMint),b=(null===(n=a.auctionManager.info.settings.participationConfig)||void 0===n?void 0:n.fixedPrice)||0,h=0===a.auctionManager.info.settings.winningConfigs.length,v=a.auction.info.priceFloor.type===S.PriceFloorType.Minimum&&(null===(i=a.auction.info.priceFloor.minPrice)||void 0===i?void 0:i.toNumber())||0,g=a.state===y.nM.Upcoming,k=(0,y.zg)(a.auction.pubkey),j=0===(null===d||void 0===d?void 0:d.hours)&&0===(null===d||void 0===d?void 0:d.minutes)&&0===(null===d||void 0===d?void 0:d.seconds),Z=0,W="";((g||f)&&(W=j?"Ended":"Starting bid",Z=(0,S.fromLamports)(h?b:v,m)),!g&&f.length>0)&&(W=j?"Winning bid":"Current bid",Z=k&&Number.isFinite(null===(t=k.info.lastBid)||void 0===t?void 0:t.toNumber())?(0,S.formatTokenAmount)(k.info.lastBid):"No Bid");var A=a.auction.info;return(0,l.useEffect)((function(){var e=function(){p(A.timeToEnd())},n=setInterval((function(){e()}),1e3);return e(),function(){return clearInterval(n)}}),[A,p]),(0,r.jsx)(w.Z,{hoverable:!0,className:"art-card",cover:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(x.$,{className:"auction-image no-events",preview:!1,pubkey:s,allowMeshRender:!1})}),children:(0,r.jsx)(E,{title:"".concat(c),description:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h4",{style:{marginBottom:0},children:W}),(0,r.jsx)("div",{className:"bids",children:(0,r.jsx)(N.T,{style:{marginBottom:10},containerStyle:{flexDirection:"row"},title:W,amount:Z})})]})})})},W=i(5632),A=i(59688),T=i(13550),C=i.n(T),P=i(45963),R=i(35551),B=u.Z.TabPane,_=d.Z.Content;!function(e){e.All="0",e.Participated="1",e.Ended="2",e.Resale="3"}(t||(t={}));var M=function(){var e=(0,y.xE)(y.nM.Live),n=(0,y.xE)(y.nM.Ended),i=(0,l.useState)(t.All),a=i[0],h=i[1],x=(0,g.jq)(),v=x.isLoading,w=x.store,N=(0,l.useState)(!1),E=N[0],T=N[1],M=(0,S.useConnection)(),I=(0,W.useRouter)(),K=(0,S.useWallet)(),V=K.wallet,F=K.connect,z=K.connected,D={default:4,1100:3,700:2,500:1},L=e.filter((function(e){return 1==function(e){var n=0;return e.items.forEach((function(e){if(e.forEach((function(e){if(1==e.metadata.info.primarySaleHappened)return n=1,!0})),1==n)return!0})),1==n}(e)})),Y=e.sort((function(e,n){var i;return(null===(i=e.auction.info.endedAt)||void 0===i?void 0:i.sub(n.auction.info.endedAt||new(C())(0)).toNumber())||0})).filter((function(e){return!L.includes(e)})),O=Y;switch(a){case t.All:O=Y;break;case t.Participated:O=Y.concat(n).filter((function(e,n){var i,t;return(null===(i=e.myBidderMetadata)||void 0===i?void 0:i.info.bidderPubkey.toBase58())==(null===V||void 0===V||null===(t=V.publicKey)||void 0===t?void 0:t.toBase58())}));break;case t.Resale:O=L;break;case t.Ended:O=n}var q=(0,l.useMemo)((function(){var n;return null===(n=e.filter((function(e){return!e.auction.info.ended()&&!L.includes(e)})))||void 0===n?void 0:n[0]}),[e]),U=(0,r.jsx)(b.Z,{breakpointCols:D,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:v?(0,c.Z)(Array(10)).map((function(e,n){return(0,r.jsx)(A.y,{},n)})):O.map((function(e,n){if(e!==q){var i=e.auction.pubkey.toBase58();return(0,r.jsx)(k.default,{href:"/auction/".concat(i),children:(0,r.jsx)("a",{children:(0,r.jsx)(Z,{auctionView:e},i)})},n)}}))}),H=(0,r.jsx)(b.Z,{breakpointCols:D,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:v?(0,c.Z)(Array(10)).map((function(e,n){return(0,r.jsx)(A.y,{},n)})):n.map((function(e,n){if(e!==q){var i=e.auction.pubkey.toBase58();return(0,r.jsx)(k.default,{href:"/auction/".concat(i),children:(0,r.jsx)("a",{children:(0,r.jsx)(Z,{auctionView:e},i)})},n)}}))}),$=(0,S.programIds)().store;return(0,r.jsxs)(d.Z,{style:{margin:0,marginTop:30,alignItems:"center"},children:[!w&&!v&&(0,r.jsxs)(r.Fragment,{children:[!$&&(0,r.jsxs)("p",{children:["Store has not been configured please set"," ",(0,r.jsx)("em",{children:"REACT_APP_STORE_OWNER_ADDRESS_ADDRESS"})," to admin wallet inside ",(0,r.jsx)("em",{children:"packages/web/.env"})," and restart yarn"]}),$&&!(null!==V&&void 0!==V&&V.publicKey)&&(0,r.jsxs)("p",{children:[(0,r.jsx)(p.Z,{type:"primary",className:"app-btn",onClick:F,children:"Connect"})," ","to configure store."]}),$&&(null===V||void 0===V?void 0:V.publicKey)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"Initializing store will allow you to control list of creators."}),(0,r.jsx)(p.Z,{className:"app-btn",type:"primary",loading:E,disabled:!$,onClick:(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==V&&void 0!==V&&V.publicKey){e.next=2;break}return e.abrupt("return");case 2:return T(!0),e.next=5,(0,P.P)(M,V,!1,[new R.JP({address:null===V||void 0===V?void 0:V.publicKey,activated:!0})]);case 5:I.push("/admin"),window.location.reload();case 7:case"end":return e.stop()}}),e)}))),children:"Init Store"})]})]}),(0,r.jsx)(j,{auction:q}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(_,{style:{display:"flex",flexWrap:"wrap"},children:(0,r.jsx)(f.Z,{style:{width:"100%",marginTop:10},children:Y.length>=0&&(0,r.jsx)(m.Z,{children:(0,r.jsxs)(u.Z,{activeKey:a,onTabClick:function(e){return h(e)},children:[(0,r.jsx)(B,{tab:(0,r.jsx)("span",{className:"tab-title",children:"Live Auctions"}),children:U},t.All),n.length>0&&(0,r.jsx)(B,{tab:(0,r.jsx)("span",{className:"tab-title",children:"Secondary Marketplace"}),children:U},t.Resale),n.length>0&&(0,r.jsx)(B,{tab:(0,r.jsx)("span",{className:"tab-title",children:"Ended Auctions"}),children:H},t.Ended),z&&(0,r.jsx)(B,{tab:(0,r.jsx)("span",{className:"tab-title",children:"Participated"}),children:U},t.Participated)]})})})})})]})},I=M}}]);